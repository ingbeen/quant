# Implementation Plan: ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ CSV ë°˜ì˜¬ë¦¼ ì •ë°€ë„ ì¡°ì •

> ì‘ì„±/ìš´ì˜ ê·œì¹™(SoT): ë°˜ë“œì‹œ [docs/CLAUDE.md](../CLAUDE.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

**ìƒíƒœ**: âœ… Done

---

ğŸš« **ì´ ì˜ì—­ì€ ì‚­ì œ/ìˆ˜ì • ê¸ˆì§€** ğŸš«

**ìƒíƒœ ì˜µì…˜**: ğŸŸ¡ Draft / ğŸ”„ In Progress / âœ… Done

**Done ì²˜ë¦¬ ê·œì¹™**:

- âœ… Done ì¡°ê±´: DoD ëª¨ë‘ [x] + `skipped=0` + `failed=0`
- âš ï¸ **ìŠ¤í‚µì´ 1ê°œë¼ë„ ì¡´ì¬í•˜ë©´ Done ì²˜ë¦¬ ê¸ˆì§€ + DoD í…ŒìŠ¤íŠ¸ í•­ëª© ì²´í¬ ê¸ˆì§€**
- ìƒì„¸: [docs/CLAUDE.md](../CLAUDE.md) ì„¹ì…˜ 3, 5 ì°¸ê³ 

---

**ì‘ì„±ì¼**: 2026-02-19 21:00
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-02-19 21:00
**ê´€ë ¨ ë²”ìœ„**: backtest, scripts, docs
**ê´€ë ¨ ë¬¸ì„œ**: `CLAUDE.md` (ë£¨íŠ¸), `src/qbt/backtest/CLAUDE.md`

---

## 0) ê³ ì • ê·œì¹™ (ì´ planì€ ë°˜ë“œì‹œ ì•„ë˜ ê·œì¹™ì„ ë”°ë¥¸ë‹¤)

> ğŸš« **ì´ ì˜ì—­ì€ ì‚­ì œ/ìˆ˜ì • ê¸ˆì§€** ğŸš«
> ì´ ì„¹ì…˜(0)ì€ ì§€ì›Œì§€ë©´ ì•ˆ ë  ë¿ë§Œ ì•„ë‹ˆë¼ **ë¬¸êµ¬ê°€ ìˆ˜ì •ë˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.**
> ê·œì¹™ì˜ ìƒì„¸ ì •ì˜/ì˜ˆì™¸ëŠ” ë°˜ë“œì‹œ [docs/CLAUDE.md](../CLAUDE.md)ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

- `poetry run python validate_project.py`ëŠ” **ë§ˆì§€ë§‰ Phaseì—ì„œë§Œ ì‹¤í–‰**í•œë‹¤. ì‹¤íŒ¨í•˜ë©´ ì¦‰ì‹œ ìˆ˜ì • í›„ ì¬ê²€ì¦í•œë‹¤.
- Phase 0ì€ "ë ˆë“œ(ì˜ë„ì  ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸)" í—ˆìš©, Phase 1ë¶€í„°ëŠ” **ê·¸ë¦° ìœ ì§€**ë¥¼ ì›ì¹™ìœ¼ë¡œ í•œë‹¤.
- ì´ë¯¸ ìƒì„±ëœ planì€ **ì²´í¬ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì™¸ ìˆ˜ì • ê¸ˆì§€**í•œë‹¤.
- ìŠ¤í‚µì€ ê°€ëŠ¥í•˜ë©´ **Phase ë¶„í•´ë¡œ ì œê±°**í•œë‹¤.

---

## 1) ëª©í‘œ(Goal)

- [x] equity CSVì˜ equity ì»¬ëŸ¼ì„ ì •ìˆ˜ë¡œ ì €ì¥ (ì†Œìˆ˜ì  `.0` ì œê±°)
- [x] trades CSVì˜ entry_price/exit_priceë¥¼ 6ìë¦¬ë¡œ ë³€ê²½ (TQQQ_synthetic_max.csv ì •ë°€ë„ ì¼ì¹˜)
- [x] trades CSVì˜ pnl ì»¬ëŸ¼ì„ ì •ìˆ˜ë¡œ ì €ì¥ (ì†Œìˆ˜ì  `.0` ì œê±°)
- [x] summary JSONì— ë™ì¼í•œ ë°˜ì˜¬ë¦¼ ê·œì¹™ ì ìš© (í•´ë‹¹ í•„ë“œ ì¡´ì¬ ì‹œ)
- [x] ë£¨íŠ¸ CLAUDE.md ë°˜ì˜¬ë¦¼ ê·œì¹™ ë¬¸ì„œ ì—…ë°ì´íŠ¸

## 2) ë¹„ëª©í‘œ(Non-Goals)

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë‚´ë¶€ ê³„ì‚° ì •ë°€ë„ ë³€ê²½ (ì €ì¥ ì§ì „ì—ë§Œ ì ìš©)
- signal CSVì˜ ê°€ê²© ì •ë°€ë„ ë³€ê²½ (QQQ ë°ì´í„° ê¸°ì¤€ 2ìë¦¬ ìœ ì§€)
- equity CSVì˜ upper_band/lower_band ì •ë°€ë„ ë³€ê²½

## 3) ë°°ê²½/ë§¥ë½(Context)

### í˜„ì¬ ë¬¸ì œì  / ë™ê¸°

- equity CSVì˜ equity ì»¬ëŸ¼ì´ `10000000.0`ì²˜ëŸ¼ `.0` ì†Œìˆ˜ì ì´ í¬í•¨ë˜ì–´ ì €ì¥ë¨
  - ìë³¸ê¸ˆì€ ì •ìˆ˜ê°€ ìì—°ìŠ¤ëŸ¬ì›€ (CLAUDE.md ê·œì¹™: ì •ìˆ˜ 0ìë¦¬)
  - pandas `.round({"equity": 0})`ëŠ” float `0.0`ì„ ìœ ì§€í•˜ë¯€ë¡œ `.astype(int)` í•„ìš”
- trades CSVì˜ entry_price/exit_priceê°€ 2ìë¦¬ë¡œ ë°˜ì˜¬ë¦¼ë˜ì–´ TQQQ_synthetic_max.csv ì›ë³¸ ì •ë°€ë„(6ìë¦¬) ìœ ì‹¤
  - TQQQ synthetic ê°€ê²©: `37.432087` (6ìë¦¬)
  - í˜„ì¬ trades CSV: `44.97` (2ìë¦¬) â†’ ì •ë°€ë„ ì†ì‹¤
- trades CSVì˜ pnlë„ equityì™€ ë™ì¼í•œ `.0` ë¬¸ì œ

### ì˜í–¥ë°›ëŠ” ê·œì¹™(ë°˜ë“œì‹œ ì½ê³  ì „ì²´ ìˆ™ì§€)

> ì•„ë˜ ë¬¸ì„œì— ê¸°ì¬ëœ ê·œì¹™ì„ **ëª¨ë‘ ìˆ™ì§€**í•˜ê³  ì¤€ìˆ˜í•©ë‹ˆë‹¤.

- `CLAUDE.md` (ë£¨íŠ¸): ì¶œë ¥ ë°ì´í„° ë°˜ì˜¬ë¦¼ ê·œì¹™
- `src/qbt/backtest/CLAUDE.md`: ë°±í…ŒìŠ¤íŠ¸ ë„ë©”ì¸ ê·œì¹™

## 4) ì™„ë£Œ ì¡°ê±´(Definition of Done)

- [x] equity CSVì˜ equity ì»¬ëŸ¼ì´ ì†Œìˆ˜ì  ì—†ì´ ì €ì¥ë¨
- [x] trades CSVì˜ entry_price/exit_priceê°€ 6ìë¦¬ë¡œ ì €ì¥ë¨
- [x] trades CSVì˜ pnl ì»¬ëŸ¼ì´ ì†Œìˆ˜ì  ì—†ì´ ì €ì¥ë¨
- [x] summary JSON í™•ì¸ ì™„ë£Œ (ë³€ê²½ ë¶ˆí•„ìš” í™•ì¸)
- [x] `poetry run python validate_project.py` í†µê³¼ (failed=0, skipped=0)
- [x] `poetry run black .` ì‹¤í–‰ ì™„ë£Œ
- [x] ë£¨íŠ¸ CLAUDE.md ë°˜ì˜¬ë¦¼ ê·œì¹™ í…Œì´ë¸” ì—…ë°ì´íŠ¸
- [x] plan ì²´í¬ë°•ìŠ¤ ìµœì‹ í™”

## 5) ë³€ê²½ ë²”ìœ„(Scope)

### ë³€ê²½ ëŒ€ìƒ íŒŒì¼(ì˜ˆìƒ)

- `scripts/backtest/run_single_backtest.py`: `_save_results()` í•¨ìˆ˜ì˜ ë°˜ì˜¬ë¦¼ ë¡œì§
- `CLAUDE.md` (ë£¨íŠ¸): ë°˜ì˜¬ë¦¼ ê·œì¹™ í…Œì´ë¸”ì— ê±°ë˜ ì²´ê²°ê°€ í•­ëª© ì¶”ê°€

### ë°ì´í„°/ê²°ê³¼ ì˜í–¥

- ê²°ê³¼ CSV íŒŒì¼ì˜ ìˆ«ì í¬ë§· ë³€ê²½ (ê°’ ìì²´ëŠ” ë™ì¼, í‘œê¸°ë§Œ ë³€ê²½)
- ëŒ€ì‹œë³´ë“œ(`app_single_backtest.py`)ì— ì˜í–¥ ì—†ìŒ (ìˆ«ì ë¡œë”© ì‹œ ìë™ íŒŒì‹±)

## 6) ë‹¨ê³„ë³„ ê³„íš(Phases)

### Phase 1 â€” ë°˜ì˜¬ë¦¼ ë¡œì§ ìˆ˜ì • + ë¬¸ì„œ ì—…ë°ì´íŠ¸

**ì‘ì—… ë‚´ìš©**:

- [x] `_save_results()` equity CSV: `.round()` í›„ `equity_export["equity"] = equity_export["equity"].astype(int)` ì¶”ê°€
- [x] `_save_results()` trades CSV: `"entry_price": 2` â†’ `"entry_price": 6`, `"exit_price": 2` â†’ `"exit_price": 6`
- [x] `_save_results()` trades CSV: `.round()` í›„ `trades_export["pnl"] = trades_export["pnl"].astype(int)` ì¶”ê°€
- [x] summary JSON í™•ì¸: `final_capital`ì€ ì´ë¯¸ `round(float(...))` = ì •ìˆ˜, entry/exit_price ë¯¸í¬í•¨ â†’ ë³€ê²½ ë¶ˆí•„ìš”
- [x] ë£¨íŠ¸ CLAUDE.md ë°˜ì˜¬ë¦¼ ê·œì¹™ í…Œì´ë¸”ì— "ê±°ë˜ ì²´ê²°ê°€" í–‰ ì¶”ê°€

---

### ë§ˆì§€ë§‰ Phase â€” ìµœì¢… ê²€ì¦

**ì‘ì—… ë‚´ìš©**

- [x] `poetry run black .` ì‹¤í–‰
- [x] `poetry run python validate_project.py` ì‹¤í–‰
- [x] DoD ì²´í¬ë¦¬ìŠ¤íŠ¸ ìµœì¢… ì—…ë°ì´íŠ¸

**Validation**:

- [x] `poetry run python validate_project.py` (passed=287, failed=0, skipped=0)

#### Commit Messages (Final candidates) â€” 5ê°œ ì¤‘ 1ê°œ ì„ íƒ

1. ë°±í…ŒìŠ¤íŠ¸ / ê²°ê³¼ CSV ë°˜ì˜¬ë¦¼ ì •ë°€ë„ ì¡°ì • (equity ì •ìˆ˜í™”, ê±°ë˜ê°€ 6ìë¦¬)
2. ë°±í…ŒìŠ¤íŠ¸ / equityÂ·pnl ì†Œìˆ˜ì  ì œê±° + ì²´ê²°ê°€ ì •ë°€ë„ ì›ë³¸ ì¼ì¹˜
3. ë°±í…ŒìŠ¤íŠ¸ / ì¶œë ¥ CSV í¬ë§· ê°œì„  (ìë³¸ê¸ˆ ì •ìˆ˜, TQQQ ê°€ê²© 6ìë¦¬ ë³´ì¡´)
4. ë°±í…ŒìŠ¤íŠ¸ / CSV ë°˜ì˜¬ë¦¼ ê·œì¹™ ë³´ì • ë° ë¬¸ì„œ ì—…ë°ì´íŠ¸
5. ë°±í…ŒìŠ¤íŠ¸ / ê±°ë˜ ê²°ê³¼ ìˆ«ì í¬ë§· ì •ë¦¬ (ì •ìˆ˜í™” + ì •ë°€ë„ í†µì¼)

## 7) ë¦¬ìŠ¤í¬(Risks)

- ë‚®ìŒ: ì €ì¥ í¬ë§·ë§Œ ë³€ê²½í•˜ë¯€ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ íšŒê·€ ìœ„í—˜ ì—†ìŒ
- ëŒ€ì‹œë³´ë“œ í˜¸í™˜: `pd.read_csv()`ê°€ int/float ëª¨ë‘ ë™ì¼í•˜ê²Œ íŒŒì‹±í•˜ë¯€ë¡œ ì˜í–¥ ì—†ìŒ

## 8) ë©”ëª¨(Notes)

- summary JSONì˜ `final_capital`ê³¼ `initial_capital`ì€ ì´ë¯¸ `round()` â†’ intë¡œ ì €ì¥ë˜ì–´ ë³€ê²½ ë¶ˆí•„ìš”
- summary JSONì— entry_price/exit_price/pnl í•„ë“œ ì—†ìŒ â†’ ë³€ê²½ ë¶ˆí•„ìš”

### ì§„í–‰ ë¡œê·¸ (KST)

- 2026-02-19 21:00: ê³„íšì„œ ì‘ì„±
- 2026-02-19 21:05: Phase 1 ì™„ë£Œ (ì½”ë“œ ìˆ˜ì • + ë¬¸ì„œ ì—…ë°ì´íŠ¸)
- 2026-02-19 21:05: ìµœì¢… ê²€ì¦ í†µê³¼ (passed=287, failed=0, skipped=0), Done
