# Implementation Plan: ì°¨íŠ¸ ì´ˆê¸° ë·° íŒ¨ë”© í¬í•¨ + íƒ­ ì „í™˜ ì‹œ ì¤Œ ìƒíƒœ ìœ ì§€

> ì‘ì„±/ìš´ì˜ ê·œì¹™(SoT): ë°˜ë“œì‹œ [docs/CLAUDE.md](../CLAUDE.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

**ìƒíƒœ**: âœ… Done

---

ğŸš« **ì´ ì˜ì—­ì€ ì‚­ì œ/ìˆ˜ì • ê¸ˆì§€** ğŸš«

**ìƒíƒœ ì˜µì…˜**: ğŸŸ¡ Draft / ğŸ”„ In Progress / âœ… Done

**Done ì²˜ë¦¬ ê·œì¹™**:

- âœ… Done ì¡°ê±´: DoD ëª¨ë‘ [x] + `skipped=0` + `failed=0`
- âš ï¸ **ìŠ¤í‚µì´ 1ê°œë¼ë„ ì¡´ì¬í•˜ë©´ Done ì²˜ë¦¬ ê¸ˆì§€ + DoD í…ŒìŠ¤íŠ¸ í•­ëª© ì²´í¬ ê¸ˆì§€**
- ìƒì„¸: [docs/CLAUDE.md](../CLAUDE.md) ì„¹ì…˜ 3, 5 ì°¸ê³ 

---

**ì‘ì„±ì¼**: 2026-02-20 18:30
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-02-20 18:45
**ê´€ë ¨ ë²”ìœ„**: vendor (lightweight-charts TSX)
**ê´€ë ¨ ë¬¸ì„œ**: `src/qbt/backtest/CLAUDE.md`, `scripts/CLAUDE.md`

---

## 0) ê³ ì • ê·œì¹™ (ì´ planì€ ë°˜ë“œì‹œ ì•„ë˜ ê·œì¹™ì„ ë”°ë¥¸ë‹¤)

> ğŸš« **ì´ ì˜ì—­ì€ ì‚­ì œ/ìˆ˜ì • ê¸ˆì§€** ğŸš«
> ì´ ì„¹ì…˜(0)ì€ ì§€ì›Œì§€ë©´ ì•ˆ ë  ë¿ë§Œ ì•„ë‹ˆë¼ **ë¬¸êµ¬ê°€ ìˆ˜ì •ë˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.**
> ê·œì¹™ì˜ ìƒì„¸ ì •ì˜/ì˜ˆì™¸ëŠ” ë°˜ë“œì‹œ [docs/CLAUDE.md](../CLAUDE.md)ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

- `poetry run python validate_project.py`ëŠ” **ë§ˆì§€ë§‰ Phaseì—ì„œë§Œ ì‹¤í–‰**í•œë‹¤. ì‹¤íŒ¨í•˜ë©´ ì¦‰ì‹œ ìˆ˜ì • í›„ ì¬ê²€ì¦í•œë‹¤.
- Phase 0ì€ "ë ˆë“œ(ì˜ë„ì  ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸)" í—ˆìš©, Phase 1ë¶€í„°ëŠ” **ê·¸ë¦° ìœ ì§€**ë¥¼ ì›ì¹™ìœ¼ë¡œ í•œë‹¤.
- ì´ë¯¸ ìƒì„±ëœ planì€ **ì²´í¬ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì™¸ ìˆ˜ì • ê¸ˆì§€**í•œë‹¤.
- ìŠ¤í‚µì€ ê°€ëŠ¥í•˜ë©´ **Phase ë¶„í•´ë¡œ ì œê±°**í•œë‹¤.

---

## 1) ëª©í‘œ(Goal)

- [x] ì´ˆê¸° ë·°ì—ì„œ ì „ì²´ ë°ì´í„° + scroll_padding íŒ¨ë”© í¬í•¨ í‘œì‹œ
- [x] íƒ­ ì „í™˜ ì‹œ ì‚¬ìš©ìì˜ í™•ëŒ€/ì¶•ì†Œ ìƒíƒœ ìœ ì§€
- [x] ìˆ¨ê²¨ì§„ íƒ­(width=0)ì—ì„œ ì²˜ìŒ í‘œì‹œë  ë•Œë„ íŒ¨ë”© í¬í•¨ ì´ˆê¸° ë·° ì •ìƒ ë™ì‘

## 2) ë¹„ëª©í‘œ(Non-Goals)

- Python ì»´í¬ë„ŒíŠ¸ ì½”ë“œ ë³€ê²½ (ê¸°ì¡´ `zoom_level=99999`, `scroll_padding=60` ìœ ì§€)
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë³€ê²½
- ìƒˆë¡œìš´ Python íŒŒë¼ë¯¸í„° ì¶”ê°€

## 3) ë°°ê²½/ë§¥ë½(Context)

### í˜„ì¬ ë¬¸ì œì  / ë™ê¸°

- Streamlit `st.tabs`ëŠ” ëª¨ë“  íƒ­ ì½˜í…ì¸ ë¥¼ ë™ì‹œ ë Œë”ë§
- ë¹„í™œì„± íƒ­ì˜ ì°¨íŠ¸ëŠ” `clientWidth=0`ì—ì„œ ìƒì„±ë˜ì–´ `fitContent()`ê°€ ë¹„ì •ìƒì ì¸ visibleRange ì‚°ì¶œ
- `handleResize`ê°€ ë¹„ì •ìƒ ë²”ìœ„ë¥¼ ë³µì›í•˜ë©´ì„œ íƒ­ ê°„ ì¼ê´€ì„± ê¹¨ì§
- `fitContent()`ëŠ” ë°ì´í„° ëì— ë”± ë§ê²Œ í‘œì‹œí•˜ì§€ë§Œ, ì‚¬ìš©ìëŠ” `scroll_padding`ë§Œí¼ ì—¬ìœ ë¥¼ ì›í•¨

### ì˜í–¥ë°›ëŠ” ê·œì¹™(ë°˜ë“œì‹œ ì½ê³  ì „ì²´ ìˆ™ì§€)

> ì•„ë˜ ë¬¸ì„œì— ê¸°ì¬ëœ ê·œì¹™ì„ **ëª¨ë‘ ìˆ™ì§€**í•˜ê³  ì¤€ìˆ˜í•©ë‹ˆë‹¤.

- `scripts/CLAUDE.md`
- `src/qbt/backtest/CLAUDE.md`

## 4) ì™„ë£Œ ì¡°ê±´(Definition of Done)

> Doneì€ "ì„œìˆ "ì´ ì•„ë‹ˆë¼ "ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒíƒœ"ë¡œë§Œ íŒë‹¨í•©ë‹ˆë‹¤. (ì •ì˜/ì˜ˆì™¸ëŠ” docs/CLAUDE.md)

- [x] ì´ˆê¸° ë·°ì—ì„œ scroll_padding íŒ¨ë”© í¬í•¨ ì „ì²´ ë°ì´í„° í‘œì‹œ
- [x] ìˆ¨ê²¨ì§„ íƒ­ë„ ì²« í‘œì‹œ ì‹œ ë™ì¼í•œ ì´ˆê¸° ë·°
- [x] íƒ­ ì „í™˜ ì‹œ í™•ëŒ€/ì¶•ì†Œ ìƒíƒœ ìœ ì§€
- [x] í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì„±ê³µ
- [x] `poetry run python validate_project.py` í†µê³¼ (failed=0, skipped=0; passed=301, failed=0, skipped=0)
- [x] `poetry run black .` ì‹¤í–‰ ì™„ë£Œ
- [x] plan ì²´í¬ë°•ìŠ¤ ìµœì‹ í™”

## 5) ë³€ê²½ ë²”ìœ„(Scope)

### ë³€ê²½ ëŒ€ìƒ íŒŒì¼

- `vendor/streamlit-lightweight-charts-v5/lightweight_charts_v5/frontend/src/LightweightChartsComponent.tsx`

### ë°ì´í„°/ê²°ê³¼ ì˜í–¥

- ì—†ìŒ (UI ì´ˆê¸° ë·° ë™ì‘ë§Œ ë³€ê²½)

## 6) ë‹¨ê³„ë³„ ê³„íš(Phases)

### Phase 1 â€” TSX ì½”ë“œ ìˆ˜ì •

**ì‘ì—… ë‚´ìš©**:

- [x] `hasInitializedView` ref ì¶”ê°€ (line ~188)
- [x] `applyInitialView` í—¬í¼ í•¨ìˆ˜ ì¶”ì¶œ (ì´ˆê¸° ì„¤ì • + ì²« ë¦¬ì‚¬ì´ì¦ˆ ê³µìœ )
- [x] ì´ˆê¸° ë·° ì„¤ì • ë³€ê²½: width=0ì´ë©´ ê±´ë„ˆë›°ê¸° (lines 682-693)
- [x] handleResize ë³€ê²½: ì²« ìœ ì˜ë¯¸í•œ ë¦¬ì‚¬ì´ì¦ˆ vs ì¼ë°˜ ë¦¬ì‚¬ì´ì¦ˆ ë¶„ê¸° (lines 747-800)
- [x] cleanupì—ì„œ `hasInitializedView` ë¦¬ì…‹

---

### Phase 2 (ë§ˆì§€ë§‰) â€” ë¹Œë“œ ë° ê²€ì¦

**ì‘ì—… ë‚´ìš©**:

- [x] í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ: `cd vendor/.../frontend && npm run build`
- [x] `poetry run black .` ì‹¤í–‰
- [x] DoD ì²´í¬ë¦¬ìŠ¤íŠ¸ ìµœì¢… ì—…ë°ì´íŠ¸
- [x] ì „ì²´ Phase ì²´í¬ë¦¬ìŠ¤íŠ¸ ìµœì¢… ì—…ë°ì´íŠ¸

**Validation**:

- [x] `poetry run python validate_project.py` (passed=301, failed=0, skipped=0)

#### Commit Messages (Final candidates) â€” 5ê°œ ì¤‘ 1ê°œ ì„ íƒ

1. ëŒ€ì‹œë³´ë“œ / ì°¨íŠ¸ ì´ˆê¸° ë·° íŒ¨ë”© í¬í•¨ í‘œì‹œ + íƒ­ ì „í™˜ ì¤Œ ìƒíƒœ ìœ ì§€
2. ëŒ€ì‹œë³´ë“œ / Streamlit íƒ­ ì „í™˜ ì‹œ ì°¨íŠ¸ ì´ˆê¸°í™” ì¼ê´€ì„± ìˆ˜ì •
3. ëŒ€ì‹œë³´ë“œ / ì°¨íŠ¸ fitContentë¥¼ íŒ¨ë”© í¬í•¨ setVisibleLogicalRangeë¡œ êµì²´
4. ëŒ€ì‹œë³´ë“œ / ìˆ¨ê²¨ì§„ íƒ­ ì°¨íŠ¸ ì´ˆê¸°í™” ë¬¸ì œ í•´ê²° + íŒ¨ë”© ì´ˆê¸° ë·°
5. ëŒ€ì‹œë³´ë“œ / ì°¨íŠ¸ ë·° ì´ˆê¸°í™” ë¡œì§ ê°œì„  (íŒ¨ë”© í‘œì‹œ + ì¤Œ ë³´ì¡´)

## 7) ë¦¬ìŠ¤í¬(Risks)

- TSX ë¹Œë“œ ì‹¤íŒ¨ ê°€ëŠ¥ì„± (TypeScript íƒ€ì… ì˜¤ë¥˜)
- `setVisibleLogicalRange`ì˜ ìŒìˆ˜ `from` ê°’ ë™ì‘ í™•ì¸ í•„ìš” (lightweight-charts ê³µì‹ ì§€ì›)

## 8) ë©”ëª¨(Notes)

- `setVisibleLogicalRange({from: -60, to: dataLength + 59})`ëŠ” ë°ì´í„° ì•ë’¤ 60ë´‰ì˜ ë¹ˆ ê³µê°„ì„ í‘œì‹œ
- scroll_padding clamperì˜ ê²½ê³„(`[-60, dataLength+59]`)ì™€ ë™ì¼í•˜ë¯€ë¡œ ìµœëŒ€ í—ˆìš© ë²”ìœ„ë¡œ ì´ˆê¸°í™”ë¨
- ì„ í–‰ plan(`PLAN_chart_initial_fit_content.md`)ì˜ `DEFAULT_ZOOM_LEVEL=99999` ë³€ê²½ì€ ìœ ì§€

### ì§„í–‰ ë¡œê·¸ (KST)

- 2026-02-20 18:30: Plan ì‘ì„± ì™„ë£Œ
- 2026-02-20 18:45: êµ¬í˜„ + ë¹Œë“œ + ê²€ì¦ ì™„ë£Œ (passed=301, failed=0, skipped=0)
- 2026-02-20 18:45: bootstrap.min.css.map ëˆ„ë½ ì—ëŸ¬ í•´ê²° (ë¹ˆ source map ìƒì„±)

---
